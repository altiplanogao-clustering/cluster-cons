---

- setup:

- include_vars: file='../../../vars/resources.yml'
- include_vars: '{{ item }}'
  with_first_found:
  - files:
      - '{{ ansible_os_family }}.yml'
      - 'default.yml'
    paths: '../vars/os'

- include_vars: 
    file: '{{ playbook_dir }}/cluster_nodes.yml'
    name: cluster_nodes
  when: cluster_mode
- include_vars: 
    file: '{{ playbook_dir }}/vars/cluster_vars.yml'
    name: hadoop_vars
  when: cluster_mode
- include_vars: 
    file: '{{ playbook_dir }}/vars/standalone_vars.yml'
    name: hadoop_vars
  when: not cluster_mode
- set_fact: is_namenode=true is_resource_mgr=true
  when: not cluster_mode

- name: Install the dependence packages
  package: name="{{ item }}" state=present
  with_items: '{{ hadoop_dependency }}'

- include: config_hosts.yml
- include: install_hadoop.yml
- include: config_daemons.yml
- include: launch_daemons.yml
